services:
  tunnel:
    container_name: cloudflared-tunnel
    image: docker.io/cloudflare/cloudflared:latest
    restart: unless-stopped
    command: tunnel run
    environment:
      - TUNNEL_TOKEN={{cloudflared_tunnel_token}}
{% if cloudflared_tunnel_token_network is defined %}
    networks:
      - shared_network
networks:
  shared_network:
    name: {{cloudflared_tunnel_token_network}}
    external: true
{% endif %}
